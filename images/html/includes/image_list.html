{% load rest_framework %}
<div id="id_image_list" class="row row-cols-auto my-2 gy-4 gx-2">

    <div class="col">
        <div class="card" style="width: 24rem;">
            <div class="card-header border-bottom">&nbsp;</div>
            <div class="card-body">
                <h5 class="card-title text-center my-2">Add an image</h5>

                <ul class="list-group list-group-flush list-group-numbered">
                    <li class="list-group-item d-flex justify-content-between align-items-start pb-3">
                        <div class="ms-2 me-auto">
                            <form 
                                hx-post="{% url 'images:image-upload' %}" 
                                hx-encoding="multipart/form-data" 
                                hx-swap="outerHTML"
                                hx-target="#id_image_list">
                                {% csrf_token %}
                                {% render_form upload_serializer %}
                                <input type="submit" value="Upload" class="btn btn-primary">
                            </form>
                        </div>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-start pb-3">
                        <div class="ms-2 me-auto">
                            <form 
                                hx-post="{% url 'images:image-fetch' %}" 
                                hx-encoding="multipart/form-data" 
                                hx-swap="outerHTML"
                                hx-target="#id_image_list">
                                {% csrf_token %}
                                {% render_form url_serializer template_pack='rest_framework/inline' %}
                                <input type="submit" value="Upload" class="btn btn-primary">
                            </form>
                        </div>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-start pb-3">
                        <div class="ms-2 me-auto">
                            <p class="">Or, get a random image:</p>
                            <form 
                                hx-post="{% url 'images:image-fetch' %}" 
                                hx-encoding="multipart/form-data" 
                                hx-swap="outerHTML"
                                hx-target="#id_image_list">
                                {% csrf_token %}
                                <input type="hidden" name="url" value="https://picsum.photos/300"/>
                                <button type="submit" class="btn btn-primary">Upload random</button>
                            </form>
                        </div>
                    </li>
                </ul>
        </div>
    </div>


    {% for image in images %}
        {% include "images/html/includes/image.html" with images=images image=image %}
    {% endfor %}
    
    <script>
        $( document ).ready(function() {
            $("#id_image_list").sortable({
                // this "works" to prevent the add image card from being moved
                // but messes with the overall arrangement
                //items: ".card:not(#id_image_add)"
            });
            $("#id_image_list").disableSelection();
        });
    </script>
</div>
